/*!
 * Copyright 2017 by Ding
 * @author Ding <ding-js@outlook.com>
 */
var ding1=webpackJsonpding_id_([1],{111:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(260);var r=i(276),a=i(78),o=i(277),h=0,n=document.querySelector("#cropper"),s=document.querySelectorAll(".preview"),c=document.querySelector("#file"),p=document.querySelector("#pick-file"),f=document.querySelector("#set-cropper"),l=f.querySelector('[name="width"]'),g=f.querySelector('[name="height"]'),d=document.querySelector("#set-btn"),u=document.querySelector("#crop-btn"),v=document.createElement("a"),_=700,m=450,w=new r.Cropper(n,{preview:Array.prototype.map.call(s,function(e,t){return{container:e,scale:.7+.3*t}}),width:_,height:m});l.setAttribute("max",""+_),g.setAttribute("max",""+m),c.addEventListener("change",function(e){var t=e.target;if(!(""===t.value||t.files.length<1)){var i=t.files[0];i.type.match(/^image\/.+/)?(w.setImage(i),p.innerHTML=i.name):a.toast("请选择正确的图片")}}),f.addEventListener("change",function(e){var t=e.target;if("input"===t.tagName.toLowerCase()){var i=+t.value,r=+t.getAttribute("max"),a=+t.getAttribute("mix");i>r?t.value=""+r:i<a?t.value=""+a:0===i&&(t.value="")}}),d.addEventListener("click",function(){var e=+l.value,t=+g.value;return e&&t?void w.setCropper(e,t):a.toast("请输入正确的宽高!")}),u.addEventListener("click",function(){try{var e=w.crop();v.href=e.toDataURL(),v.download="ding-cropper-"+ ++h+".png",v.click(),a.toast("我就不假装上传了!")}catch(e){console.error(e),a.toast('不支持HTML5,建议使用<a href="https://www.google.com/chrome/">「Chrome浏览器」浏览本页面!</a>')}}),function(){var e=new Image;e.src=o,e.onload=function(){w.setImage(e)}}()},260:function(e,t){},276:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.cropper=0]="cropper",e[e.image=1]="image",e[e.point=2]="point",e[e.background=3]="background"}(r||(r={}));var a=function(){function e(e,t){var i=this;this._image={},this._cropper={},this._scale=1,this._isPreview=!1,this._previewList=[],this._lineWidth=1,this._pointWidth=8,this._pointHeight=8,this.handleImageMove=function(e){var t=[e.offsetX,e.offsetY],r=t[0],a=t[1],o=[i._xOffset,i._yOffset],h=o[0],n=o[1];i._image.x=r-h,i._image.y=a-n},this.handleCropperMove=function(e){var t=[e.offsetX,e.offsetY],r=t[0],a=t[1],o=[i._xOffset,i._yOffset,i._cropper.width,i._cropper.height,i._width,i._height],h=o[0],n=o[1],s=o[2],c=o[3],p=o[4],f=o[5],l=r-h,g=a-n;r<h&&(l=0),r>p-s+h&&(l=p-s),a<n&&(g=0),a>f-c+n&&(g=f-c),i._cropper.x=l,i._cropper.y=g},this.preview=function(){if(i._image.element&&i._isPreview){var e=i.getCropperData();e&&(i._previewScaleCtx.clearRect(0,0,i._cropper.width,i._cropper.height),i._previewScaleCtx.putImageData(e.imageData,e.offsetX,e.offsetY),i._previewList.forEach(function(t){var r=t.ctx,a=t.canvas;r.clearRect(0,0,a.width,a.height),1!==t.scale?(r.scale(t.scale,t.scale),r.drawImage(i._previewScaleCanvas,0,0),r.setTransform(1,0,0,1,0,0)):r.putImageData(e.imageData,e.offsetX,e.offsetY)}))}};var r={width:+e.offsetWidth,height:+e.offsetHeight};Object.assign(r,t),this._container=e,this._options=r,this._width=r.width,this._height=r.height;try{this.init()}catch(e){alert("不支持canvas"),console.error(e)}}return e.prototype.init=function(){var e=this,t=this._container,i=document.createElement("canvas"),a=i.getContext("2d"),o=this._options;Object.assign(i,{width:this._width,height:this._height}),this._ctx=a,this._canvas=i,t.appendChild(i),o.preview&&Array.isArray(o.preview)&&(o.preview.forEach(function(t){var i=document.createElement("canvas"),r=i.getContext("2d"),a=+t.scale;t.container.appendChild(i);var o={canvas:i,ctx:r,scale:a>0?a:1};e._previewList.push(o)}),this._previewScaleCanvas=document.createElement("canvas"),this._previewScaleCtx=this._previewScaleCanvas.getContext("2d"),this._isPreview=!0),i.addEventListener("mousewheel",function(t){var i=e._image;if(t.preventDefault(),i.element){var r=i.element.width,a=i.element.height,o=void 0,h=e._scale,n=t.deltaY/800;o=n>0?1/(1+n):1+Math.abs(n),o*=h,e._scale=o,r*=o,a*=o,i.x+=(i.width-r)/2,i.y+=(i.height-a)/2,i.width=r,i.height=a,e.draw()}}),i.addEventListener("mousedown",function(t){if(1===t.which){var i=[t.offsetX,t.offsetY],a=i[0],o=i[1],h=e.getPoint(),n=e._cropper,s=e._image;e._moving=!0,a>h.x&&a<h.x+h.width&&o>h.y&&o<h.y+h.height?(e._xOffset=a-h.x,e._yOffset=o-h.y,e._targetType=r.point):a>n.x&&a<n.x+n.width&&o>n.y&&o<n.y+n.height?(e._xOffset=a-n.x,e._yOffset=o-n.y,e._targetType=r.cropper):a>s.x&&a<s.x+s.width&&o>s.y&&o<s.y+s.height?(e._xOffset=a-s.x,e._yOffset=o-s.y,e._targetType=r.image):(e._targetType=r.background,e._moving=!1)}}),window.addEventListener("mouseup",function(t){1===t.which&&(e._moving=!1)}),i.addEventListener("mousemove",function(t){if(e._moving){switch(e._targetType){case r.cropper:e.handleCropperMove(t);break;case r.image:e.handleImageMove(t);break;case r.point:e.handlePointMove(t);break;default:return}e.draw()}})},e.prototype.handlePointMove=function(e){var t=[e.offsetX,e.offsetY],i=t[0],r=t[1],a=[i-this._cropper.x-this._xOffset+this._pointWidth/2,r-this._cropper.y-this._yOffset+this._pointHeight/2],o=a[0],h=a[1];o<=0||h<=0||this.setCropper(o,h,!1)},e.prototype.getPoint=function(){var e=this._cropper,t=this._pointWidth,i=this._pointHeight,r=e.x+e.width-t/2,a=e.y+e.height-i/2;return{width:t,height:i,x:r,y:a}},e.prototype.fillBackground=function(){var e=this._ctx,t=this._width,i=this._height,r=t/40,a=Math.ceil(t/r),o=Math.ceil(i/r);e.save(),e.fillStyle="#ccc";for(var h=0,n=0;n<o;n++)for(var s=0;s<a;s++)(h+n)%2===0&&e.fillRect(s*r,n*r,r,r),h++;e.fillStyle="rgba(0,0,0,0.1)",e.fillRect(0,0,t,i),e.restore()},e.prototype.fillImage=function(){var e=this._ctx,t=this._image;t&&e.drawImage(t.element,t.x,t.y,t.width,t.height)},e.prototype.fillCropper=function(){var e=this._image;if(e.element){var t=this._ctx,i=this._cropper;t.save(),t.strokeStyle="#39f",t.lineWidth=this._lineWidth,t.strokeRect(i.x,i.y,i.width,i.height),t.fillStyle="#39f";var r=this.getPoint();t.fillRect(r.x,r.y,r.width,r.height),t.restore()}},e.prototype.getCropperData=function(){var e=this._image,t=this._cropper,i=[t.x,t.y,t.height,t.width],r=i[0],a=i[1],o=i[2],h=i[3],n=0,s=0;if(t.x<e.x&&(r=e.x,n=e.x-t.x,h-=n),t.y<e.y&&(a=e.y,s=e.y-t.y,o-=s),t.x+t.width>e.x+e.width&&(h-=t.x+t.width-(e.x+e.width)),t.y+t.height>e.y+e.height&&(o-=t.y+t.height-(e.y+e.height)),!(h<0||o<0))return{width:h,height:o,x:r,y:a,offsetX:n,offsetY:s,imageData:this._ctx.getImageData(r,a,h,o)}},e.prototype.draw=function(){this._ctx.clearRect(0,0,this._width,this._height),this.fillImage(),this.preview(),this._ctx.clearRect(0,0,this._width,this._height),this.fillBackground(),this.fillImage(),this.fillCropper()},e.prototype.crop=function(){if(!this._image.element)return void console.error("请添加一张图片");this._ctx.clearRect(0,0,this._width,this._height),this.fillImage();var e=this.getCropperData();if(e){var t=document.createElement("canvas"),i=t.getContext("2d");return Object.assign(t,{width:this._cropper.width,height:this._cropper.height}),i.putImageData(e.imageData,e.offsetX,e.offsetY),this.draw(),t}},e.prototype.resetImage=function(e){if(!e){if(!this._image.element)return;e=this._image.element}if(e.src){var t=e.width,i=e.height,r=this._width,a=this._height,o=r/3,h=a/3,n=t,s=i,c=1;t>r&&(n=r,c=n/t,s=c*i),s>a&&(s=a,c=s/i,n=c*t),Object.assign(this._image,{element:e,width:n,height:s,x:(r-n)/2,y:(a-s)/2}),this._scale=c,this.setCropper(o,h)}},e.prototype.setImage=function(e){var t=this;if(e instanceof HTMLImageElement)this.resetImage(e);else{if(!(e instanceof File))return;e.type.match(/^image\/.+$/)||console.error("请选择正确的图片文件");var i=new FileReader;this._image={},i.onload=function(e){var i=new Image;i.src=e.target.result,i.onload=function(){t.resetImage(i)}},i.readAsDataURL(e)}},e.prototype.setPreview=function(e){void 0===e&&(e=!0);var t=this._cropper;if(this._isPreview){var i=[this._width,this._height],r=i[0],a=i[1];e&&(t.x=r/2-t.width/2,t.y=a/2-t.height/2),this._previewScaleCanvas&&Object.assign(this._previewScaleCanvas,{width:t.width,height:t.height}),this._previewList.forEach(function(e){Object.assign(e.canvas,{width:t.width*e.scale,height:t.height*e.scale})})}},e.prototype.setCropper=function(e,t,i){void 0===i&&(i=!0),Object.assign(this._cropper,{width:e,height:t}),this.setPreview(i),this.draw()},Object.defineProperty(e.prototype,"previewScale",{set:function(e){this.setPreview(),this.draw()},enumerable:!0,configurable:!0}),e}();t.Cropper=a},277:function(e,t,i){e.exports=i.p+"file/b8b85b3a2fdd58e2.jpg"},281:function(e,t,i){i(28),e.exports=i(111)},75:function(e,t){},77:function(e,t,i){"use strict";function r(e){var t=[],i=window.innerWidth,r=window.innerHeight,o=.04*i,h=.06*r,n=.01*i,s=.01*i,c=function(e,t){var i=e.el,a=t.el;a.offsetHeight+a.offsetTop+i.offsetHeight+n+h>r?e.setTopRight(h,t.right+a.offsetWidth+s):e.setTopRight(t.top+a.offsetHeight+n,t.right)};return function(i,r){void 0===r&&(r=e.delay);var n=new a(i);t.length>0?c(n,t[t.length-1]):n.setTopRight(h,o),t.push(n),n.show(),setTimeout(function(){if(n.hide(),t.splice(0,1),t.length>0&&(t[0].setTopRight(h,o),t.length>1))for(var e=1,i=t.length;e<i;e++)c(t[e],t[e-1])},r)}}Object.defineProperty(t,"__esModule",{value:!0}),i(75),t.default=r;var a=function(){function e(e){var t=this;this.show=function(){t._el.classList.add("show")},this.hide=function(){t._el.classList.remove("show"),t._el.classList.add("hide"),setTimeout(function(){document.body.removeChild(t._el)},300)},Object.assign(this,{_msg:e}),this.init()}return e.prototype.init=function(){var e=document.createElement("div");e.classList.add("toast"),e.innerHTML=this._msg,document.body.appendChild(e),this._el=e},e.prototype.setTopRight=function(e,t){var i=this.el;this.top=e,this.right=t,Object.assign(i.style,{top:e+"px",right:t+"px"})},Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),e}()},78:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(77),a=r.default({delay:5e3});t.toast=a}},[281]);