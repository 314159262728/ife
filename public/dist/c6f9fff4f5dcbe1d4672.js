/*!
 * Copyright 2017 by Ding
 * @author Ding <ding-js@outlook.com>
 */
var ding1=webpackJsonpding_id_([1],{111:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(261);var r=i(279),o=i(78),a=i(282),n=0,s=document.querySelector("#cropper"),h=document.querySelectorAll(".preview"),c=document.querySelector("#file"),p=document.querySelector("#pick-file"),f=document.querySelector("#set-cropper"),l=f.querySelector('[name="width"]'),d=f.querySelector('[name="height"]'),g=document.querySelector("#set-btn"),u=document.querySelector("#crop-btn"),v=document.createElement("a"),_=700,m=450,w=new r.Cropper(s,{preview:Array.prototype.map.call(h,function(e,t){return{container:e,scale:.7+.3*t}}),width:_,height:m});l.setAttribute("max",""+_),d.setAttribute("max",""+m),c.addEventListener("change",function(e){var t=e.target;if(!(""===t.value||t.files.length<1)){var i=t.files[0];i.type.match(/^image\/.+/)?(w.setImage(i),p.innerHTML=i.name):o.toast("请选择正确的图片")}}),f.addEventListener("change",function(e){var t=e.target;if("input"===t.tagName.toLowerCase()){var i=+t.value,r=+t.getAttribute("max"),o=+t.getAttribute("mix");i>r?t.value=""+r:i<o?t.value=""+o:0===i&&(t.value="")}}),g.addEventListener("click",function(){var e=+l.value,t=+d.value;return e&&t?void w.setCropper(e,t):o.toast("请输入正确的宽高!")}),u.addEventListener("click",function(){try{var e=w.crop();v.href=e.toDataURL(),v.download="ding-cropper-"+ ++n+".png",v.click(),o.toast("我就不假装上传了!")}catch(e){console.error(e),o.toast('不支持HTML5,建议使用<a href="https://www.google.com/chrome/">「Chrome浏览器」浏览本页面!</a>')}}),function(){var e=new Image;e.src=a,e.onload=function(){w.setImage(e)}}()},261:function(e,t){},279:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.cropper=0]="cropper",e[e.image=1]="image",e[e.pointRD=2]="pointRD",e[e.background=3]="background"}(r||(r={}));var o=function(){function e(e,t){var i=this;this._image={},this._cropper={},this._scale=1,this._isPreview=!1,this._previewList=[],this._lineWidth=1,this._pointWidth=8,this._pointHeight=8,this.handlePointMove=function(e){var t=[e.offsetX,e.offsetY],r=t[0],o=t[1],a=r-i._cropper.x-i._xOffset+i._pointWidth/2,n=o-i._cropper.y-i._yOffset+i._pointHeight/2;a<=0||n<=0||i.setCropper(a,n,!1)},this.handleImageMove=function(e){var t=[e.offsetX,e.offsetY],r=t[0],o=t[1],a=[i._xOffset,i._yOffset],n=a[0],s=a[1];i._image.x=r-n,i._image.y=o-s},this.handleCropperMove=function(e){var t=[e.offsetX,e.offsetY],r=t[0],o=t[1],a=[i._xOffset,i._yOffset,i._cropper.width,i._cropper.height,i._width,i._height],n=a[0],s=a[1],h=a[2],c=a[3],p=a[4],f=a[5],l=r-n,d=o-s;r<n&&(l=0),r>p-h+n&&(l=p-h),o<s&&(d=0),o>f-c+s&&(d=f-c),i._cropper.x=l,i._cropper.y=d},this.preview=function(){if(i._image.element&&i._isPreview){var e=i.getCropperData();e&&(i._previewScaleCtx.clearRect(0,0,i._cropper.width,i._cropper.height),i._previewScaleCtx.putImageData(e.imageData,e.offsetX,e.offsetY),i._previewList.forEach(function(t){var r=t.ctx,o=t.canvas;r.clearRect(0,0,o.width,o.height),1!==t.scale?(r.scale(t.scale,t.scale),r.drawImage(i._previewScaleCanvas,0,0),r.setTransform(1,0,0,1,0,0)):r.putImageData(e.imageData,e.offsetX,e.offsetY)}))}};var o={width:+e.offsetWidth,height:+e.offsetHeight};Object.assign(o,t),this._container=e,this._options=o,this._width=o.width,this._height=o.height,this._targetTypes=(a={},a[r.cropper]={cursor:"all-scroll",handle:this.handleCropperMove},a[r.image]={cursor:"default",handle:this.handleImageMove},a[r.pointRD]={cursor:"nwse-resize",handle:this.handlePointMove},a[r.background]={cursor:"default"},a);try{this.init()}catch(e){alert("不支持canvas"),console.error(e)}var a}return e.prototype.init=function(){var e=this,t=this._container,i=document.createElement("canvas"),o=i.getContext("2d"),a=this._options;Object.assign(i,{width:this._width,height:this._height}),this._ctx=o,this._canvas=i,t.appendChild(i),a.preview&&Array.isArray(a.preview)&&(a.preview.forEach(function(t){var i=document.createElement("canvas"),r=i.getContext("2d"),o=+t.scale;t.container.appendChild(i);var a={canvas:i,ctx:r,scale:o>0?o:1};e._previewList.push(a)}),this._previewScaleCanvas=document.createElement("canvas"),this._previewScaleCtx=this._previewScaleCanvas.getContext("2d"),this._isPreview=!0),i.addEventListener("mousewheel",function(t){var i=e._image;if(t.preventDefault(),i.element){var r=i.element.width,o=i.element.height,a=void 0,n=e._scale,s=t.deltaY/800;a=s>0?1/(1+s):1+Math.abs(s),a*=n,e._scale=a,r*=a,o*=a,i.x+=(i.width-r)/2,i.y+=(i.height-o)/2,i.width=r,i.height=o,e.draw()}}),i.addEventListener("mousedown",function(t){if(1===t.which){var i=e.getTypeInfo(t);i.type===r.background?e._moving=!1:(e._targetType=i.type,e._xOffset=i.offsetX,e._yOffset=i.offsetY,e._moving=!0)}}),window.addEventListener("mouseup",function(t){1===t.which&&(e._moving=!1)}),i.addEventListener("mousemove",function(t){var i=e.getTypeInfo(t),r=e._targetTypes[i.type],o=e._targetTypes[e._targetType];if(e._moving&&o.handle)o.handle(t),e.draw();else if(r.cursor){var a=e._container.style.cursor;a!==r.cursor&&(e._container.style.cursor=r.cursor)}})},e.prototype.getTypeInfo=function(e){var t=[e.offsetX,e.offsetY],i=t[0],o=t[1],a=this.getPoint(),n=this._cropper,s=this._image,h={};return i>a.x&&i<a.x+a.width&&o>a.y&&o<a.y+a.height?(h.offsetX=i-a.x,h.offsetY=o-a.y,h.type=r.pointRD):i>n.x&&i<n.x+n.width&&o>n.y&&o<n.y+n.height?(h.offsetX=i-n.x,h.offsetY=o-n.y,h.type=r.cropper):i>s.x&&i<s.x+s.width&&o>s.y&&o<s.y+s.height?(h.offsetX=i-s.x,h.offsetY=o-s.y,h.type=r.image):h.type=r.background,h},e.prototype.getPoint=function(){var e=this._cropper,t=this._pointWidth,i=this._pointHeight,r=e.x+e.width-t/2,o=e.y+e.height-i/2;return{width:t,height:i,x:r,y:o}},e.prototype.fillBackground=function(){var e=this._ctx,t=this._width,i=this._height,r=t/40,o=Math.ceil(t/r),a=Math.ceil(i/r);e.save(),e.fillStyle="#ccc";for(var n=0,s=0;s<a;s++)for(var h=0;h<o;h++)(n+s)%2===0&&e.fillRect(h*r,s*r,r,r),n++;e.fillStyle="rgba(0,0,0,0.1)",e.fillRect(0,0,t,i),e.restore()},e.prototype.fillImage=function(){var e=this._ctx,t=this._image;t&&e.drawImage(t.element,t.x,t.y,t.width,t.height)},e.prototype.fillCropper=function(){var e=this._image;if(e.element){var t=this._ctx,i=this._cropper;t.save(),t.strokeStyle="#39f",t.lineWidth=this._lineWidth,t.strokeRect(i.x,i.y,i.width,i.height),t.fillStyle="#39f";var r=this.getPoint();t.fillRect(r.x,r.y,r.width,r.height),t.restore()}},e.prototype.getCropperData=function(){var e=this._image,t=this._cropper,i=[t.x,t.y,t.height,t.width],r=i[0],o=i[1],a=i[2],n=i[3],s=0,h=0;if(t.x<e.x&&(r=e.x,s=e.x-t.x,n-=s),t.y<e.y&&(o=e.y,h=e.y-t.y,a-=h),t.x+t.width>e.x+e.width&&(n-=t.x+t.width-(e.x+e.width)),t.y+t.height>e.y+e.height&&(a-=t.y+t.height-(e.y+e.height)),!(n<0||a<0))return{width:n,height:a,x:r,y:o,offsetX:s,offsetY:h,imageData:this._ctx.getImageData(r,o,n,a)}},e.prototype.draw=function(){this._ctx.clearRect(0,0,this._width,this._height),this.fillImage(),this.preview(),this._ctx.clearRect(0,0,this._width,this._height),this.fillBackground(),this.fillImage(),this.fillCropper()},e.prototype.crop=function(){if(!this._image.element)return void console.error("请添加一张图片");this._ctx.clearRect(0,0,this._width,this._height),this.fillImage();var e=this.getCropperData();if(e){var t=document.createElement("canvas"),i=t.getContext("2d");return Object.assign(t,{width:this._cropper.width,height:this._cropper.height}),i.putImageData(e.imageData,e.offsetX,e.offsetY),this.draw(),t}},e.prototype.resetImage=function(e){if(!e){if(!this._image.element)return;e=this._image.element}if(e.src){var t=e.width,i=e.height,r=this._width,o=this._height,a=r/3,n=o/3,s=t,h=i,c=1;t>r&&(s=r,c=s/t,h=c*i),h>o&&(h=o,c=h/i,s=c*t),Object.assign(this._image,{element:e,width:s,height:h,x:(r-s)/2,y:(o-h)/2}),this._scale=c,this.setCropper(a,n)}},e.prototype.setImage=function(e){var t=this;if(e instanceof HTMLImageElement)this.resetImage(e);else{if(!(e instanceof File))return;e.type.match(/^image\/.+$/)||console.error("请选择正确的图片文件");var i=new FileReader;this._image={},i.onload=function(e){var i=new Image;i.src=e.target.result,i.onload=function(){t.resetImage(i)}},i.readAsDataURL(e)}},e.prototype.setPreview=function(e){void 0===e&&(e=!0);var t=this._cropper;if(this._isPreview){var i=[this._width,this._height],r=i[0],o=i[1];e&&(t.x=r/2-t.width/2,t.y=o/2-t.height/2),this._previewScaleCanvas&&Object.assign(this._previewScaleCanvas,{width:t.width,height:t.height}),this._previewList.forEach(function(e){Object.assign(e.canvas,{width:t.width*e.scale,height:t.height*e.scale})})}},e.prototype.setCropper=function(e,t,i){void 0===i&&(i=!0),Object.assign(this._cropper,{width:e,height:t}),this.setPreview(i),this.draw()},Object.defineProperty(e.prototype,"previewScale",{set:function(e){this.setPreview(),this.draw()},enumerable:!0,configurable:!0}),e}();t.Cropper=o},282:function(e,t,i){e.exports=i.p+"file/b8b85b3a2fdd58e2.jpg"},286:function(e,t,i){i(18),e.exports=i(111)},75:function(e,t){},77:function(e,t,i){"use strict";function r(e){var t=[],i=window.innerWidth,r=window.innerHeight,a=.04*i,n=.06*r,s=.01*i,h=.01*i,c=function(e,t){var i=e.el,o=t.el;o.offsetHeight+o.offsetTop+i.offsetHeight+s+n>r?e.setTopRight(n,t.right+o.offsetWidth+h):e.setTopRight(t.top+o.offsetHeight+s,t.right)};return function(i,r){void 0===r&&(r=e.delay);var s=new o(i);t.length>0?c(s,t[t.length-1]):s.setTopRight(n,a),t.push(s),s.show(),setTimeout(function(){if(s.hide(),t.splice(0,1),t.length>0&&(t[0].setTopRight(n,a),t.length>1))for(var e=1,i=t.length;e<i;e++)c(t[e],t[e-1])},r)}}Object.defineProperty(t,"__esModule",{value:!0}),i(75),t.default=r;var o=function(){function e(e){var t=this;this.show=function(){t._el.classList.add("show")},this.hide=function(){t._el.classList.remove("show"),t._el.classList.add("hide"),setTimeout(function(){document.body.removeChild(t._el)},300)},Object.assign(this,{_msg:e}),this.init()}return e.prototype.init=function(){var e=document.createElement("div");e.classList.add("toast"),e.innerHTML=this._msg,document.body.appendChild(e),this._el=e},e.prototype.setTopRight=function(e,t){var i=this.el;this.top=e,this.right=t,Object.assign(i.style,{top:e+"px",right:t+"px"})},Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),e}()},78:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(77),o=r.default({delay:5e3});t.toast=o}},[286]);