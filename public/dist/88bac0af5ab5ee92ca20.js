/*!
 * Copyright 2017 by Ding
 * @author Ding <ding-js@outlook.com>
 */
var ding1=webpackJsonpding_id_([1],{111:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(260);var r=i(276),o=i(78),a=i(277),h=document.querySelector("#cropper"),s=document.querySelector("#preview"),n=document.querySelector("#file"),p=document.querySelector("#pick-file"),c=document.querySelector("#set-cropper"),g=c.querySelector('[name="width"]'),_=c.querySelector('[name="height"]'),f=document.querySelector("#set-btn"),d=document.querySelector("#crop-btn"),l=document.querySelector("#crop-image"),u=700,v=450,m=new r.Cropper(h,{preview:s,width:u,height:v});g.setAttribute("max",""+u),_.setAttribute("max",""+v),n.addEventListener("change",function(e){var t=e.target;if(!(""===t.value||t.files.length<1)){var i=t.files[0];i.type.match(/^image\/.+/)&&(m.setImage(i),p.innerHTML=i.name)}}),c.addEventListener("change",function(e){var t=e.target;if("input"===t.tagName.toLowerCase()){var i=+t.value,r=+t.getAttribute("max"),o=+t.getAttribute("mix");i>r?t.value=""+r:i<o?t.value=""+o:0===i&&(t.value="")}}),f.addEventListener("click",function(){var e=+g.value,t=+_.value;if(!e||!t)return o.toast("请输入正确的宽高!");m.setCropper(e,t)}),d.addEventListener("click",function(){var e=m.crop();l.src=e.toDataURL(),o.toast("裁剪成功,我就不假装上传了!")});var w=new Image;w.src=a,w.onload=function(){m.setImage(w)}},260:function(e,t){},276:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.cropper=0]="cropper",e[e.image=1]="image",e[e.point=2]="point",e[e.background=3]="background"}(r||(r={}));var o=function(){function e(e,t){var i=this;this._scale=1,this._preview=!1,this._lineWidth=1,this._pointWidth=8,this._pointHeight=8,this.handleImageMove=function(e){var t=[e.layerX,e.layerY],r=t[0],o=t[1],a=[i._xOffset,i._yOffset],h=a[0],s=a[1];i._imageX=r-h,i._imageY=o-s},this.handleCropperMove=function(e){var t=[e.layerX,e.layerY],r=t[0],o=t[1],a=[i._xOffset,i._yOffset,i._cropperWidth,i._cropperHeight,i._width,i._height],h=a[0],s=a[1],n=a[2],p=a[3],c=a[4],g=a[5],_=r-h,f=o-s;r<h&&(_=0),r>c-n+h&&(_=c-n),o<s&&(f=0),o>g-p+s&&(f=g-p),i._cropperX=_,i._cropperY=f},this.preview=function(){if(i._image&&i._preview){var e=i.getCropperData(),t=i._previewCtx;t.clearRect(0,0,i._width,i._height),e&&t.putImageData(e.imageData,e.offsetX,e.offsetY)}};var r={width:+e.offsetWidth,height:+e.offsetHeight};Object.assign(r,t),this._container=e,this._options=r,this._width=r.width,this._height=r.height,this.init()}return e.prototype.init=function(){var e=this,t=this._container,i=document.createElement("canvas"),o=i.getContext("2d"),a=this._options;if(Object.assign(i,{width:this._width,height:this._height}),this._ctx=o,this._canvas=i,t.appendChild(i),a.preview){var h=document.createElement("canvas"),s=h.getContext("2d");a.preview.appendChild(h),this._previewCanvas=h,this._previewCtx=s,this._preview=!0}i.addEventListener("mousewheel",function(t){var i=e._image;if(t.preventDefault(),e._image){var r=i.width,o=i.height,a=void 0,h=e._scale,s=t.deltaY/800;a=s>0?1/(1+s):1+Math.abs(s),a*=h,e._scale=a,r*=a,o*=a,e._imageX+=(e._imageWidth-r)/2,e._imageY+=(e._imageHeight-o)/2,e._imageWidth=r,e._imageHeight=o,e.draw()}}),i.addEventListener("mousedown",function(t){if(1===t.which){var i=[t.layerX,t.layerY],o=i[0],a=i[1],h=e.getPoint();e._moving=!0,o>h.x&&o<h.x+h.width&&a>h.y&&a<h.y+h.height?(e._xOffset=o-h.x,e._yOffset=a-h.y,e._area=r.point):o>e._cropperX&&o<e._cropperX+e._cropperWidth&&a>e._cropperY&&a<e._cropperY+e._cropperHeight?(e._xOffset=o-e._cropperX,e._yOffset=a-e._cropperY,e._area=r.cropper):o>e._imageX&&o<e._imageX+e._imageWidth&&a>e._imageY&&a<e._imageY+e._imageHeight?(e._xOffset=o-e._imageX,e._yOffset=a-e._imageY,e._area=r.image):(e._area=r.background,e._moving=!1)}}),window.addEventListener("mouseup",function(t){1===t.which&&(e._moving=!1)}),i.addEventListener("mousemove",function(t){if(e._moving){switch(e._area){case r.cropper:e.handleCropperMove(t);break;case r.image:e.handleImageMove(t);break;case r.point:e.handlePointMove(t);break;default:return}e.draw()}})},e.prototype.handlePointMove=function(e){var t=[e.layerX,e.layerY],i=t[0],r=t[1],o=[i-this._cropperX-this._xOffset,r-this._cropperY-this._yOffset],a=o[0],h=o[1];a<=0||h<=0||this.setCropper(a,h,!1)},e.prototype.getPoint=function(){var e=this._pointWidth,t=this._pointHeight;return{width:e,height:t,x:this._cropperX+this._cropperWidth-e/2,y:this._cropperY+this._cropperHeight-t/2}},e.prototype.fillBackground=function(){var e=this._ctx,t=this._width,i=this._height,r=t/40,o=Math.ceil(t/r),a=Math.ceil(i/r);e.save(),e.fillStyle="#ccc";for(var h=0,s=0;s<a;s++)for(var n=0;n<o;n++)(h+s)%2==0&&e.fillRect(n*r,s*r,r,r),h++;e.fillStyle="rgba(0,0,0,0.2)",e.fillRect(0,0,t,i),e.restore()},e.prototype.fillImage=function(){var e=this._ctx,t=this._image;t&&e.drawImage(t,this._imageX,this._imageY,this._imageWidth,this._imageHeight)},e.prototype.fillCropper=function(){if(this._image){var e=this._ctx;e.save(),e.strokeStyle="#39f",e.lineWidth=this._lineWidth,e.strokeRect(this._cropperX,this._cropperY,this._cropperWidth,this._cropperHeight),e.fillStyle="#39f";var t=this.getPoint();e.fillRect(t.x,t.y,t.width,t.height),e.restore()}},e.prototype.getCropperData=function(){var e=[this._imageX,this._imageY,this._imageHeight,this._imageWidth],t=e[0],i=e[1],r=e[2],o=e[3],a=[this._cropperX,this._cropperY,this._cropperHeight,this._cropperWidth],h=a[0],s=a[1],n=a[2],p=a[3],c=[h,s,n,p],g=c[0],_=c[1],f=c[2],d=c[3],l=0,u=0;if(h<t&&(g=t,l=g-h,d-=l),s<i&&(_=i,u=_-s,f-=u),h+p>t+o&&(d-=h+p-(t+o)),s+n>i+r&&(f-=s+n-(i+r)),!(d<0||f<0))return{width:d,height:f,x:g,y:_,offsetX:l,offsetY:u,imageData:this._ctx.getImageData(g,_,d,f)}},e.prototype.draw=function(){this._ctx.clearRect(0,0,this._width,this._height),this.fillBackground(),this.fillImage(),this.preview(),this.fillCropper()},e.prototype.crop=function(){if(!this._image)return void console.error("请添加一张图片");this._ctx.clearRect(0,0,this._width,this._height),this.fillImage();var e=this.getCropperData();if(e){var t=document.createElement("canvas"),i=t.getContext("2d");return Object.assign(t,{width:this._cropperWidth,height:this._cropperHeight}),i.putImageData(e.imageData,e.offsetX,e.offsetY),this.draw(),t}},e.prototype.resetImage=function(e){if(!e){if(!this._image)return;e=this._image}if(e.src){var t=e.width,i=e.height,r=this._width,o=this._height,a=r/3,h=o/3,s=t,n=i,p=1;t>r&&(s=r,p=s/t,n=p*i),n>o&&(n=o,p=n/i,s=p*t),Object.assign(this,{_image:e,_imageWidth:s,_imageHeight:n,_imageX:(r-s)/2,_imageY:(o-n)/2,_scale:p}),this.setCropper(a,h)}},e.prototype.setImage=function(e){var t=this;if(e instanceof HTMLImageElement)this.resetImage(e);else{if(!(e instanceof File))return;e.type.match(/^image\/.+$/)||console.error("请选择正确的图片文件");var i=new FileReader;this._image=null,i.onload=function(e){var i=new Image;i.src=e.target.result,i.onload=function(){t.resetImage(i)}},i.readAsDataURL(e)}},e.prototype.setPreview=function(e){void 0===e&&(e=!0);var t=this._cropperWidth,i=this._cropperHeight;if(this._preview){var r=[this._width,this._height],o=r[0],a=r[1];e&&(this._cropperX=o/2-t/2,this._cropperY=a/2-i/2),this._previewWidth=t,this._previewHeight=i,Object.assign(this._previewCanvas,{width:this._previewWidth,height:this._previewHeight})}},e.prototype.setCropper=function(e,t,i){void 0===i&&(i=!0),this._cropperWidth=e,this._cropperHeight=t,this.setPreview(i),this.draw()},Object.defineProperty(e.prototype,"previewScale",{set:function(e){this.setPreview(),this.draw()},enumerable:!0,configurable:!0}),e}();t.Cropper=o},277:function(e,t,i){e.exports=i.p+"file/b8b85b3a2fdd58e2.jpg"},281:function(e,t,i){i(28),e.exports=i(111)},75:function(e,t){},77:function(e,t,i){"use strict";function r(e){var t=[],i=window.innerWidth,r=window.innerHeight,a=.04*i,h=.06*r,s=.01*i,n=.01*i,p=function(e,t){var i=e.el,o=t.el;o.offsetHeight+o.offsetTop+i.offsetHeight+s+h>r?e.setTopRight(h,t.right+o.offsetWidth+n):e.setTopRight(t.top+o.offsetHeight+s,t.right)};return function(i,r){void 0===r&&(r=e.delay);var s=new o(i);t.length>0?p(s,t[t.length-1]):s.setTopRight(h,a),t.push(s),s.show(),setTimeout(function(){if(s.hide(),t.splice(0,1),t.length>0&&(t[0].setTopRight(h,a),t.length>1))for(var e=1,i=t.length;e<i;e++)p(t[e],t[e-1])},r)}}Object.defineProperty(t,"__esModule",{value:!0}),i(75),t.default=r;var o=function(){function e(e){var t=this;this.show=function(){t._el.classList.add("show")},this.hide=function(){t._el.classList.remove("show"),t._el.classList.add("hide"),setTimeout(function(){document.body.removeChild(t._el)},300)},Object.assign(this,{_msg:e}),this.init()}return e.prototype.init=function(){var e=document.createElement("div"),t=document.createTextNode(this._msg);e.classList.add("toast"),e.appendChild(t),document.body.appendChild(e),this._el=e},e.prototype.setTopRight=function(e,t){var i=this.el;this.top=e,this.right=t,Object.assign(i.style,{top:e+"px",right:t+"px"})},Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),e}()},78:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(77),o=r.default({delay:5e3});t.toast=o}},[281]);