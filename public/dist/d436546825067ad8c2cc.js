/*!
 * Copyright 2017 by Ding
 * @author Ding <ding-js@outlook.com>
 */
var ding1=webpackJsonpding_id_([1],{111:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(260);var r=i(276),a=i(78),h=i(277),n=document.querySelector("#cropper"),o=document.querySelectorAll(".preview"),s=document.querySelector("#file"),c=document.querySelector("#pick-file"),p=document.querySelector("#set-cropper"),l=p.querySelector('[name="width"]'),f=p.querySelector('[name="height"]'),d=document.querySelector("#set-btn"),g=document.querySelector("#crop-btn"),u=document.querySelector("#crop-image"),v=700,_=450,m=new r.Cropper(n,{preview:Array.prototype.map.call(o,function(e,t){return{container:e,scale:.7+.3*t}}),width:v,height:_});l.setAttribute("max",""+v),f.setAttribute("max",""+_),s.addEventListener("change",function(e){var t=e.target;if(!(""===t.value||t.files.length<1)){var i=t.files[0];i.type.match(/^image\/.+/)&&(m.setImage(i),c.innerHTML=i.name)}}),p.addEventListener("change",function(e){var t=e.target;if("input"===t.tagName.toLowerCase()){var i=+t.value,r=+t.getAttribute("max"),a=+t.getAttribute("mix");i>r?t.value=""+r:i<a?t.value=""+a:0===i&&(t.value="")}}),d.addEventListener("click",function(){var e=+l.value,t=+f.value;return e&&t?void m.setCropper(e,t):a.toast("请输入正确的宽高!")}),g.addEventListener("click",function(){var e=m.crop();u.src=e.toDataURL(),a.toast("裁剪成功,我就不假装上传了!")});var w=new Image;w.src=h,w.onload=function(){m.setImage(w)}},260:function(e,t){},276:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.cropper=0]="cropper",e[e.image=1]="image",e[e.point=2]="point",e[e.background=3]="background"}(r||(r={}));var a=function(){function e(e,t){var i=this;this._image={},this._cropper={},this._scale=1,this._isPreview=!1,this._previewList=[],this._lineWidth=1,this._pointWidth=8,this._pointHeight=8,this.handleImageMove=function(e){var t=[e.layerX,e.layerY],r=t[0],a=t[1],h=[i._xOffset,i._yOffset],n=h[0],o=h[1];i._image.x=r-n,i._image.y=a-o},this.handleCropperMove=function(e){var t=[e.layerX,e.layerY],r=t[0],a=t[1],h=[i._xOffset,i._yOffset,i._cropper.width,i._cropper.height,i._width,i._height],n=h[0],o=h[1],s=h[2],c=h[3],p=h[4],l=h[5],f=r-n,d=a-o;r<n&&(f=0),r>p-s+n&&(f=p-s),a<o&&(d=0),a>l-c+o&&(d=l-c),i._cropper.x=f,i._cropper.y=d},this.preview=function(){if(i._image.element&&i._isPreview){var e=i.getCropperData();e&&(i._previewScaleCtx.clearRect(0,0,i._cropper.width,i._cropper.height),i._previewScaleCtx.putImageData(e.imageData,e.offsetX,e.offsetY),i._previewList.forEach(function(t){var r=t.ctx,a=t.canvas;r.clearRect(0,0,a.width,a.height),1!==t.scale?(r.scale(t.scale,t.scale),r.drawImage(i._previewScaleCanvas,0,0),r.setTransform(1,0,0,1,0,0)):r.putImageData(e.imageData,e.offsetX,e.offsetY)}))}};var r={width:+e.offsetWidth,height:+e.offsetHeight};Object.assign(r,t),this._container=e,this._options=r,this._width=r.width,this._height=r.height,this.init()}return e.prototype.init=function(){var e=this,t=this._container,i=document.createElement("canvas"),a=i.getContext("2d"),h=this._options;Object.assign(i,{width:this._width,height:this._height}),this._ctx=a,this._canvas=i,t.appendChild(i),h.preview&&Array.isArray(h.preview)&&(h.preview.forEach(function(t){var i=document.createElement("canvas"),r=i.getContext("2d"),a=+t.scale;t.container.appendChild(i);var h={canvas:i,ctx:r,scale:a>0?a:1};e._previewList.push(h)}),this._previewScaleCanvas=document.createElement("canvas"),this._previewScaleCtx=this._previewScaleCanvas.getContext("2d"),this._isPreview=!0),i.addEventListener("mousewheel",function(t){var i=e._image;if(t.preventDefault(),i.element){var r=i.element.width,a=i.element.height,h=void 0,n=e._scale,o=t.deltaY/800;h=o>0?1/(1+o):1+Math.abs(o),h*=n,e._scale=h,r*=h,a*=h,i.x+=(i.width-r)/2,i.y+=(i.height-a)/2,i.width=r,i.height=a,e.draw()}}),i.addEventListener("mousedown",function(t){if(1===t.which){var i=[t.layerX,t.layerY],a=i[0],h=i[1],n=e.getPoint(),o=e._cropper,s=e._image;e._moving=!0,a>n.x&&a<n.x+n.width&&h>n.y&&h<n.y+n.height?(e._xOffset=a-n.x,e._yOffset=h-n.y,e._targetType=r.point):a>o.x&&a<o.x+o.width&&h>o.y&&h<o.y+o.height?(e._xOffset=a-o.x,e._yOffset=h-o.y,e._targetType=r.cropper):a>s.x&&a<s.x+s.width&&h>s.y&&h<s.y+s.height?(e._xOffset=a-s.x,e._yOffset=h-s.y,e._targetType=r.image):(e._targetType=r.background,e._moving=!1)}}),window.addEventListener("mouseup",function(t){1===t.which&&(e._moving=!1)}),i.addEventListener("mousemove",function(t){if(e._moving){switch(e._targetType){case r.cropper:e.handleCropperMove(t);break;case r.image:e.handleImageMove(t);break;case r.point:e.handlePointMove(t);break;default:return}e.draw()}})},e.prototype.handlePointMove=function(e){var t=[e.layerX,e.layerY],i=t[0],r=t[1],a=[i-this._cropper.x-this._xOffset+this._pointWidth/2,r-this._cropper.y-this._yOffset+this._pointHeight/2],h=a[0],n=a[1];h<=0||n<=0||this.setCropper(h,n,!1)},e.prototype.getPoint=function(){var e=this._cropper,t=this._pointWidth,i=this._pointHeight,r=e.x+e.width-t/2,a=e.y+e.height-i/2;return{width:t,height:i,x:r,y:a}},e.prototype.fillBackground=function(){var e=this._ctx,t=this._width,i=this._height,r=t/40,a=Math.ceil(t/r),h=Math.ceil(i/r);e.save(),e.fillStyle="#ccc";for(var n=0,o=0;o<h;o++)for(var s=0;s<a;s++)(n+o)%2===0&&e.fillRect(s*r,o*r,r,r),n++;e.fillStyle="rgba(0,0,0,0.2)",e.fillRect(0,0,t,i),e.restore()},e.prototype.fillImage=function(){var e=this._ctx,t=this._image;t&&e.drawImage(t.element,t.x,t.y,t.width,t.height)},e.prototype.fillCropper=function(){var e=this._image;if(e.element){var t=this._ctx,i=this._cropper;t.save(),t.strokeStyle="#39f",t.lineWidth=this._lineWidth,t.strokeRect(i.x,i.y,i.width,i.height),t.fillStyle="#39f";var r=this.getPoint();t.fillRect(r.x,r.y,r.width,r.height),t.restore()}},e.prototype.getCropperData=function(){var e=this._image,t=this._cropper,i=[t.x,t.y,t.height,t.width],r=i[0],a=i[1],h=i[2],n=i[3],o=0,s=0;if(t.x<e.x&&(r=e.x,o=e.x-t.x,n-=o),t.y<e.y&&(a=e.y,s=e.y-t.y,h-=s),t.x+t.width>e.x+e.width&&(n-=t.x+t.width-(e.x+e.width)),t.y+t.height>e.y+e.height&&(h-=t.y+t.height-(e.y+e.height)),!(n<0||h<0))return{width:n,height:h,x:r,y:a,offsetX:o,offsetY:s,imageData:this._ctx.getImageData(r,a,n,h)}},e.prototype.draw=function(){this._ctx.clearRect(0,0,this._width,this._height),this.fillImage(),this.preview(),this._ctx.clearRect(0,0,this._width,this._height),this.fillBackground(),this.fillImage(),this.fillCropper()},e.prototype.crop=function(){if(!this._image.element)return void console.error("请添加一张图片");this._ctx.clearRect(0,0,this._width,this._height),this.fillImage();var e=this.getCropperData();if(e){var t=document.createElement("canvas"),i=t.getContext("2d");return Object.assign(t,{width:this._cropper.width,height:this._cropper.height}),i.putImageData(e.imageData,e.offsetX,e.offsetY),this.draw(),t}},e.prototype.resetImage=function(e){if(!e){if(!this._image.element)return;e=this._image.element}if(e.src){var t=e.width,i=e.height,r=this._width,a=this._height,h=r/3,n=a/3,o=t,s=i,c=1;t>r&&(o=r,c=o/t,s=c*i),s>a&&(s=a,c=s/i,o=c*t),Object.assign(this._image,{element:e,width:o,height:s,x:(r-o)/2,y:(a-s)/2}),this._scale=c,this.setCropper(h,n)}},e.prototype.setImage=function(e){var t=this;if(e instanceof HTMLImageElement)this.resetImage(e);else{if(!(e instanceof File))return;e.type.match(/^image\/.+$/)||console.error("请选择正确的图片文件");var i=new FileReader;this._image={},i.onload=function(e){var i=new Image;i.src=e.target.result,i.onload=function(){t.resetImage(i)}},i.readAsDataURL(e)}},e.prototype.setPreview=function(e){void 0===e&&(e=!0);var t=this._cropper;if(this._isPreview){var i=[this._width,this._height],r=i[0],a=i[1];e&&(t.x=r/2-t.width/2,t.y=a/2-t.height/2),this._previewScaleCanvas&&Object.assign(this._previewScaleCanvas,{width:t.width,height:t.height}),this._previewList.forEach(function(e){Object.assign(e.canvas,{width:t.width*e.scale,height:t.height*e.scale})})}},e.prototype.setCropper=function(e,t,i){void 0===i&&(i=!0),Object.assign(this._cropper,{width:e,height:t}),this.setPreview(i),this.draw()},Object.defineProperty(e.prototype,"previewScale",{set:function(e){this.setPreview(),this.draw()},enumerable:!0,configurable:!0}),e}();t.Cropper=a},277:function(e,t,i){e.exports=i.p+"file/b8b85b3a2fdd58e2.jpg"},281:function(e,t,i){i(28),e.exports=i(111)},75:function(e,t){},77:function(e,t,i){"use strict";function r(e){var t=[],i=window.innerWidth,r=window.innerHeight,h=.04*i,n=.06*r,o=.01*i,s=.01*i,c=function(e,t){var i=e.el,a=t.el;a.offsetHeight+a.offsetTop+i.offsetHeight+o+n>r?e.setTopRight(n,t.right+a.offsetWidth+s):e.setTopRight(t.top+a.offsetHeight+o,t.right)};return function(i,r){void 0===r&&(r=e.delay);var o=new a(i);t.length>0?c(o,t[t.length-1]):o.setTopRight(n,h),t.push(o),o.show(),setTimeout(function(){if(o.hide(),t.splice(0,1),t.length>0&&(t[0].setTopRight(n,h),t.length>1))for(var e=1,i=t.length;e<i;e++)c(t[e],t[e-1])},r)}}Object.defineProperty(t,"__esModule",{value:!0}),i(75),t.default=r;var a=function(){function e(e){var t=this;this.show=function(){t._el.classList.add("show")},this.hide=function(){t._el.classList.remove("show"),t._el.classList.add("hide"),setTimeout(function(){document.body.removeChild(t._el)},300)},Object.assign(this,{_msg:e}),this.init()}return e.prototype.init=function(){var e=document.createElement("div"),t=document.createTextNode(this._msg);e.classList.add("toast"),e.appendChild(t),document.body.appendChild(e),this._el=e},e.prototype.setTopRight=function(e,t){var i=this.el;this.top=e,this.right=t,Object.assign(i.style,{top:e+"px",right:t+"px"})},Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),e}()},78:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(77),a=r.default({delay:5e3});t.toast=a}},[281]);