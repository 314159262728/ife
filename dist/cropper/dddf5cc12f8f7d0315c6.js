/*!
 * Copyright 2017 by Ding
 * @author Ding <ding-js@outlook.com>
 */
var ding3=webpackJsonpding_id_([3],{108:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),t(258);var r=t(276),h=document.querySelector("#cropper"),a=document.querySelector("#preview"),o=document.querySelector("#file"),s=new r.Cropper(h,{preview:a});o.addEventListener("change",function(e){var i=e.target;""===i.value||i.files.length<1||s.changeImage(i.files[0])})},258:function(e,i){},276:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){e[e.cropper=0]="cropper",e[e.image=1]="image",e[e.background=2]="background"}(r||(r={}));var h=function(){function e(e,i){var t=this;this._scaleOffset=0,this.handleCropperMove=function(e){var i=[e.layerX,e.layerY],r=i[0],h=i[1],a=[t._xOffset,t._yOffset,t._cropperWidth,t._cropperHeight,t._width,t._height],o=a[0],s=a[1],_=a[2],c=a[3],n=a[4],g=a[5],p=r-o,d=h-s;r<o&&(p=0),r>n-_+o&&(p=n-_),h<s&&(d=0),h>g-c+s&&(d=g-c),t._cropperX=p,t._cropperY=d},this._container=e,this._options=i,this.init()}return e.prototype.init=function(){var e=this,i=this._container,t=document.createElement("canvas"),h=t.getContext("2d");this._width=+i.offsetWidth,this._height=+i.offsetHeight,Object.assign(t,{width:this._width,height:this._height}),this._ctx=h,this._canvas=t,i.appendChild(t),t.addEventListener("mousewheel",function(i){var t=e._image;if(e._image){var r=t.width,h=t.height,a=e._scaleOffset+i.deltaY;if(e._scaleOffset=a,0!==a){var o=void 0;o=a>0?1/(1+a/800):1+Math.abs(a)/800,r*=o,h*=o,e._imageX+=(e._imageWidth-r)/2,e._imageY+=(e._imageHeight-h)/2,e._imageWidth=r,e._imageHeight=h}e.draw()}}),t.addEventListener("mousedown",function(i){if(1===i.which){var t=[i.layerX,i.layerY],h=t[0],a=t[1];e._moving=!0,h>e._cropperX&&h<e._cropperX+e._cropperWidth&&a>e._cropperY&&a<e._cropperY+e._cropperHeight?(e._xOffset=h-e._cropperX,e._yOffset=a-e._cropperY,e._area=r.cropper):h>e._imageX&&h<e._imageX+e._imageWidth&&a>e._imageY&&a<e._imageY+e._imageHeight?e._area=r.image:(e._area=r.background,e._moving=!1)}}),window.addEventListener("mouseup",function(i){1===i.which&&(e._moving=!1)}),t.addEventListener("mousemove",function(i){if(e._moving){switch(e._area){case r.cropper:e.handleCropperMove(i)}e.draw()}})},e.prototype.fillBackground=function(){var e=this._ctx,i=this._width,t=this._height,r=i/40,h=Math.ceil(i/r),a=Math.ceil(t/r);e.save(),e.fillStyle="#ccc";for(var o=0,s=0;s<a;s++)for(var _=0;_<h;_++)(o+s)%2===0&&e.fillRect(_*r,s*r,r,r),o++;e.fillStyle="rgba(0,0,0,0.2)",e.fillRect(0,0,i,t),e.restore()},e.prototype.fillImage=function(){var e=this._ctx,i=this._image;i&&(void 0===this._imageWidth&&(this._imageWidth=i.width),void 0===this._imageHeight&&(this._imageHeight=i.height),void 0===this._imageX&&(this._imageX=(this._width-this._imageWidth)/2),void 0===this._imageY&&(this._imageY=(this._height-this._imageHeight)/2),e.drawImage(i,this._imageX,this._imageY,this._imageWidth,this._imageHeight))},e.prototype.fillCropper=function(){if(this._image){var e=this._ctx,i=this._image,t=i.width,r=i.height,h=1;e.save(),void 0===this._cropperWidth&&(this._cropperWidth=t/2),void 0===this._cropperHeight&&(this._cropperHeight=r/2),void 0===this._cropperX&&(this._cropperX=this._width/2-this._imageWidth/4),void 0===this._cropperY&&(this._cropperY=this._height/2-this._imageHeight/4),e.strokeStyle="#000",e.lineWidth=h,e.strokeRect(this._cropperX,this._cropperY,this._cropperWidth,this._cropperHeight),e.restore()}},e.prototype.draw=function(){var e=this._ctx;e.clearRect(0,0,this._width,this._height),this.fillBackground(),this.fillImage(),this.fillCropper()},e.prototype.changeImage=function(e){var i=this;if(!e.type.match(/^image\/.+$/))return void console.error("请选择正确的图片文件");var t=new FileReader;this._image=null,t.onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){i._image=t,i._imageWidth=t.width,i._imageHeight=t.height,i.draw()}},t.readAsDataURL(e)},e}();i.Cropper=h},280:function(e,i,t){t(108),e.exports=t(28)}},[280]);